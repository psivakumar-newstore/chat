openapi: 3.0.0
info:
  title: Order Injection API
  version: '0.1'
  description: >
    Represents a current order or a historical order placed using an external
    system, identified by its

    `external_id` in NewStore. An order contains a list of shipments and the
    products in each shipment.
servers:
  - url: https://dodici.x.newstore.net/v0/d
paths:
  /fulfill_order:
    post:
      summary: Create order
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: >-
            - If the same order is sent twice, the same response is returned
            each time.

            - If a different order with the same `external_id` is sent, a
            response identical to the response for the first order is returned.

            - No modifications are made to the order after it is created. 
          content:
            application/json:
              example:
                schema:
                  external_id: INJECTED_6fa1c9c1-daf7-4aac-96bd-1a1436affb5d
                  id: c93e1a37-b5d2-41a5-a3d0-4c3756b5fa3e
                  items:
                    - external_item_id: EXT1000761
                      id: 03a06f1c-4797-441e-ac15-a07a3df23a92
                      product_id: '1000761'
              schema:
                type: object
                required:
                  - id
                  - external_id
                  - items
                properties:
                  id:
                    description: >-
                      The identifier of the order assigned internally by the
                      system.
                    type: string
                    minLength: 1
                    maxLength: 64
                  external_id:
                    type: string
                    minLength: 1
                    maxLength: 64
                  items:
                    description: Identifiers of the order items.
                    type: array
                    minItems: 1
                    items:
                      type: object
                      required:
                        - product_id
                        - external_item_id
                        - id
                      properties:
                        product_id:
                          type: string
                          description: The product id from the catalog.
                          minLength: 1
                          maxLength: 64
                        external_item_id:
                          type: string
                          description: >-
                            The external order item id as specified in the
                            request.
                          minLength: 1
                          maxLength: 64
                        id:
                          type: string
                          description: >-
                            An identifier that is assigned to the item by the
                            system.
                          minLength: 36
                          maxLength: 36
        '400':
          description: >
            - The input data is invalid.

            - Multiple shipping options are provided that are identified by
            service level identifiers.

            - Mixed shipping option types are provided that are identified by
            service level identifiers and 
               shipping offer tokens.
            - Price is specified with invalid number of decimal places according
            to the specified currency. 
               For example, if the currency is specified as ``USD`` and the product price has more than 2 decimal places, it is considered as invalid by the platform. 
               For more information, see [pricing dependencies on currency](https://docs.newstore.com/v1/docs/set-up-payments#managing-product-pricing-dependencies-on-currency).
            - The order's total payment amount is different from the sum of each
            item and shipping amount.
               For example, if the incorrect `price_method` is sent or if the `item_discount_info` or `item_order_discount_info` are missing.
          content:
            application/json:
              example:
                schema:
                  error_code: invalid_shipments
                  message: >-
                    Failed to read shipping options by shipping offer token. At
                    least one of the provided shipping offer tokens could not be
                    parsed.
              schema:
                type: object
                required:
                  - error_code
                properties:
                  error_code:
                    type: string
                    minLength: 1
                  message:
                    type: string
        '500':
          description: >-
            An internal error occurred. In most cases the error is transient and
            the request should be retried with the same payload.
             - shipping_provider_communication_error: There was a transient error getting shipping options from the shipping providers. A retry with the same payload will likely fix the issue. If not, check your integration with the shipping providers.
             - grpc_unavailable: Some part of the Newstore platform was temporarily unavailable. A retry with the same payload will likely fix the issue.
             - rpc_timeout: An internal call timed out. A retry with the same payload will likely fix the issue.
             - rpc_timeout for sales_order: An internal call timed out. WARNING: The order may have been partially created. The request needs to be retried with the same payload to complete the order creation in the platform.
          content:
            application/json:
              example:
                schema:
                  error_code: shipping_provider_communication_error
                  message: Could not get shipping offers.
              schema:
                type: object
                required:
                  - error_code
                properties:
                  error_code:
                    type: string
                    minLength: 1
                  message:
                    type: string
        '504':
          description: >-
            Your order injection request is experiencing delays, possibly due to
            high system load or slow responses from your configured shipping
            providers. Even though this specific call failed, we are continuing
            to process your order injection in the background. If the order data
            is valid, an order will be automatically created, without requiring
            additional calls to this endpoint. To check the status of your order
            injection, simply retry this call. If the process is complete,
            you'll receive an immediate response.
      description: >
        Creates an order in NewStore by importing an order placed via an
        external system.

        This is also referred as *injecting an order*.


        Each request creates a single order in NewStore.


        The request payload depends on the order you are creating. For example:


        - A pre-routed order relies on a `routing strategy` defined with the

        [fulfillment
        configuration](/newstore-cloud/newstore.html#fulfillment-configuration).

        - An in-store pickup order relies on the `in-store configuration`
        defined

        with the [in-store pickup config
        resource](/newstore-cloud/store_operations/in_store_pickup.html).


        This method is idempotent, with regards to the `external_id` property.
        You can use the

        method multiple times to create the same order in the platform. The
        order itself is created

        only once, with the same response payload returned every time.


        There can be transient errors (`500`) when creating an order, such as a
        timeout when communicating

        with the shipping provider. To fix these errors, retry the method again
        with the same payload.


        **Important**:

        - Ensure that the request payload is same when creating an order with
        several

        tries. A retry with the same `external_id` but a different payload will
        fail.

        - Ensure that there is a small delay between each retry.

        - Only the `200` response implies that the order has been created
        correctly. Therefore,

        ensure that your integration has a retry logic set up.


        For more information, see the request examples and

        [Importing orders](https://docs.newstore.com/docs/importing-orders).


        **Configuration**

        There are two configuration settings that impact injection flow:
        `big_sales_order` 

        and `skip_soft_routing_on_injection`. For more information, see the page
        with all 

        [order_injection
        configuration](https://docs.newstore.net/newstore-cloud/routing/order_injection_admin.html#operation/updateConfig).


        **Notes:**

        - Ensure that you specify the correct number of decimal places for
        monetary values of

        prices, according to the specified currency. For example, if the
        currency is specified as

        ``USD`` and the price has more than 2 decimal places, it is considered
        as invalid by the

        platform. For more information, see

        [pricing dependencies on
        currency](https://docs.newstore.com/v1/docs/set-up-payments#managing-product-pricing-dependencies-on-currency).

        - To send payment-related metadata with the order, use the

        [Create financial
        instrument](https://docs.newstore.net/api/webhooks/fat_psp_hook/#operation/createFinancialInstrument)

        method in the Payment Provider webhooks.

        - The validity of a shipping offer token can vary based on the shipping

        provider and shipping offer. For `in-store pickup` orders, a shipping
        offer

        token does not expire.

        - If you set `shipments[].shipment_option.routing_strategy` as
        "external" and the routing failed to communicate

        with shipping provider, the order will be cancelled. Check shipping
        provider integration, if you have customer 

        integration, otherwise contact team delivery for support.

        - If the customer's phone number does not have a country calling code,
        the platform will attempt to use the

        billing address country code to derive the calling code while formatting
        the phone number to the E.164

        standard. If the phone number cannot be formatted, it will be placed in
        the extended attribute 

        `injected-invalid-phone-number` on customer profile. It can be updated
        later, if needed.
      operationId: CreateOrder
      requestBody:
        content:
          application/json:
            examples:
              current_order:
                summary: Current order
                description: >
                  From a mobile customer app with notifications suppressed.

                  To send payment-related metadata with the order, use the

                  [Create financial
                  instrument](https://docs.newstore.net/api/webhooks/fat_psp_hook/#operation/createFinancialInstrument)
                  method.
                value:
                  external_id: INJECTED_regular-123456
                  placed_at: '2018-10-08T07:06:08.067Z'
                  shop: storefront-catalog-en
                  store_id: 807b05a4-5554-5302-a67f-aa3293107e92
                  associate_id: 3045c2140d2e4a5ba0f2ddc0a27d8798
                  channel_type: mobile
                  channel_name: retailer android app
                  currency: USD
                  customer_name: Jay Doubleyou
                  customer_email: jw@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: CON0962868711
                  notification_blacklist:
                    - invoice_created
                    - refund_note_created
                  shipping_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    address_line_2: ''
                    phone: 987654321
                  billing_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  shipments:
                    - items:
                        - external_item_id: EXT1000761
                          product_id: '1000761'
                          price:
                            item_price: 50
                            item_list_price: 50
                            item_tax_lines:
                              - amount: 13
                                rate: 0.0758
                                name: Custom Tax
                                country_code: US
                      shipping_option:
                        shipping_offer_token: >-
                          eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ1dWlkIjoiYWM4Yzc5NjEtODNlNi00YTBmLWFmNjAtNjc5MjYwZjY1NjMwIiwiZnVsZmlsbG1lbnRfbm9kZV9pZCI6IlVTMDEiLCJ6aXBfY29kZSI6IjEwMDIyIiwiY291bnRyeV9jb2RlIjoiVVMiLCJzaGlwcGluZ190eXBlIjoic2FtZV9kYXlfZGVsaXZlcnkiLCJzZXJ2aWNlX2xldmVsX2lkZW50aWZpZXIiOiIyX0RBWSIsImNhcnJpZXJfY29kZSI6IkFDTUVfVFJBRElUSU9OQUwiLCJwcm92aWRlcl9yYXRlX2lkZW50aWZpZXIiOiJBQ01FXzJfREFZX0VYUFJFU1MiLCJkZWxpdmVyeV9lc3RpbWF0ZSI6eyJpZCI6ImV5SjBlWEFpT2lKS1YxUWlMQ0poYkdjaU9pSklVekkxTmlKOS5leUpqY21WaGRHVmtYMkYwSWpvaU1qQXhPQzB3TnkweU5GUXhNem8xTkRvMU15NHlOemM1T1RFaUxDSnZabVpsY2w5cFpDSTZJazFZVWxsWFdsSlJXa0pGVERaT1RrWWlmUS5UQ1NQZFRHZ2ZrRl9haGczQzR2TXZlTzhGbXRoWWNsalZ6RXp5SDJaYlY4IiwiZGVsaXZlcnlfd2luZG93Ijp7InN0YXJ0c19hdCI6IjIwMTgtMDctMjZUMDg6MDA6MDAuMDAwMDAwIiwiZW5kc19hdCI6IjIwMTgtMDctMjZUMTk6MDA6MDAuMDAwMDAwIn19fQ.T6uHXuq-lgUOhxgQudGMhYTaVrQMCsuq5P3JOxEF0BwLbhYZpi04Eaz4-F3ByCYhDyAZnrekcMz-maJtJz5R_HL4RLlB8tzNR22QFYVqYJtMvVMUJYDg96qfZ1buoXHit7DGcYgz2QX5CGYFGNMjTwe4WO1X1gBT746GabadVxuKwvTyCJWMX58UcAyYxzgQfDjdp-tZO8mcCdHOzCaP_d0099LMYMY_7P5NnyrlZrOziZH0WGtYUqqew1xeEu51uC2jEV6bhuCX42Wj4bz6q7qiETOfX1KaOxBBe5VkYUvBtBBdfKn5g10ZDCwrsINsCVVhuXdIW8kzPl5vfbWQTw
                        price: 19
                        tax: 6.78
                  payments:
                    - processor: adyen
                      correlation_ref: ch_1DIsE9GMCeo3G7b40EbEjfZX
                      type: captured
                      amount: 68.78
                      method: credit_card
                      processed_at: '2018-10-08T07:06:08.067Z'
                  price_method: tax_excluded
              in_store_pickup_order:
                summary: In-store pickup order
                description: >
                  An order to be collected from the store. Notice that the
                  shipping address isn't required. The

                  `shipping_offer_token` property comes from the

                  [Get in-store pickup
                  options](/newstore-cloud/store_operations/in_store_pickup.html#operation/GetIn-StorePickupOptions)
                  method.
                value:
                  external_id: ORDER-234YE4YNL-2226
                  shop: storefront-catalog-en
                  channel_type: web
                  channel_name: External order
                  currency: EUR
                  customer_name: John Doe
                  customer_email: jdoe@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: '6932760230624376023466'
                  shipments:
                    - items:
                        - external_item_id: Item_2226
                          product_id: '1000081'
                          price:
                            item_price: 36.74
                            item_list_price: 36.74
                            item_tax_lines:
                              - amount: 2.93
                                rate: 0.0625
                                name: Custom Tax
                                country_code: US
                            item_discount_info: []
                            item_order_discount_info:
                              - description: >-
                                  Discount for mismatch value between order
                                  total and paid total from Shopify
                                discount_ref: Mismatch value from Shopify
                                coupon_code: Mismatch value from Shopify
                                price_adjustment: 4.11
                                type: fixed
                                original_value: 4.11
                            pricebook: default
                          extended_attributes:
                            - name: item-level
                              value: attribute
                      shipping_option:
                        shipping_offer_token: eyJhbGciOiJSUzI1NiITAxMTcifQ.diM4BObG
                        price: 0
                        tax: 0
                  extended_attributes:
                    - name: order-level
                      value: attribute
                  billing_address:
                    title: ''
                    suffix: ''
                    salutation: ''
                    first_name: John
                    last_name: Dor
                    country: US
                    zip_code: '10017'
                    city: New York
                    state: NY
                    address_line_1: 1 United Nations Plaza
                    address_line_2: ''
                    phone: 1-800-111-2233
                  payments:
                    - processor: cash
                      correlation_ref: CASH_2226
                      type: captured
                      amount: 34.93
                      processed_at: '2019-07-20T05:47:53Z'
                      method: cash
                  price_method: tax_excluded
              mixed_order:
                summary: Mixed order BOPIS and shipping
                description: >
                  An order has two shipments:


                  #. In-store pickup

                  #. "Standard" shipment (non-in-store pickup)


                  The `shipping_offer_token` property of the in-store pickup
                  shipment comes from the

                  [Get in-store pickup
                  options](/newstore-cloud/store_operations/in_store_pickup.html#operation/GetIn-StorePickupOptions)
                  method.


                  The `shipping_offer_token` property of the "standard" shipment
                  with shipping comes from the

                  [Create routing options](#operation/GetRoutingOptions) method.


                  The request has a single shipping address that is only
                  relevant for the shipping part of the order.

                  It is only possible to inject mixed orders with
                  `shipping_offer_token`. `service_level_identifier` is not
                  supported.
                value:
                  external_id: INJECTED_mixed_bopis_shipping-123
                  placed_at: '2018-10-08T07:06:08.067Z'
                  shop: storefront-catalog-en
                  channel_type: web
                  channel_name: sfcc integration
                  currency: USD
                  customer_name: Jay Doubleyou
                  customer_email: jw@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: CON0962868711
                  notification_blacklist:
                    - invoice_created
                    - refund_note_created
                  shipping_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    address_line_2: ''
                    phone: 987654321
                  billing_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  shipments:
                    - items:
                        - external_item_id: EXT1000761
                          product_id: '1000761'
                          price:
                            item_price: 50
                            item_list_price: 50
                            item_tax_lines:
                              - amount: 13
                                rate: 0.0758
                                name: Custom Tax
                                country_code: US
                      shipping_option:
                        shipping_offer_token: >-
                          eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ1dWlkIjoiYWM4Yzc5NjEtODNlNi00YTBmLWFmNjAtNjc5MjYwZjY1NjMwIiwiZnVsZmlsbG1lbnRfbm9kZV9pZCI6IlVTMDEiLCJ6aXBfY29kZSI6IjEwMDIyIiwiY291bnRyeV9jb2RlIjoiVVMiLCJzaGlwcGluZ190eXBlIjoic2FtZV9kYXlfZGVsaXZlcnkiLCJzZXJ2aWNlX2xldmVsX2lkZW50aWZpZXIiOiIyX0RBWSIsImNhcnJpZXJfY29kZSI6IkFDTUVfVFJBRElUSU9OQUwiLCJwcm92aWRlcl9yYXRlX2lkZW50aWZpZXIiOiJBQ01FXzJfREFZX0VYUFJFU1MiLCJkZWxpdmVyeV9lc3RpbWF0ZSI6eyJpZCI6ImV5SjBlWEFpT2lKS1YxUWlMQ0poYkdjaU9pSklVekkxTmlKOS5leUpqY21WaGRHVmtYMkYwSWpvaU1qQXhPQzB3TnkweU5GUXhNem8xTkRvMU15NHlOemM1T1RFaUxDSnZabVpsY2w5cFpDSTZJazFZVWxsWFdsSlJXa0pGVERaT1RrWWlmUS5UQ1NQZFRHZ2ZrRl9haGczQzR2TXZlTzhGbXRoWWNsalZ6RXp5SDJaYlY4IiwiZGVsaXZlcnlfd2luZG93Ijp7InN0YXJ0c19hdCI6IjIwMTgtMDctMjZUMDg6MDA6MDAuMDAwMDAwIiwiZW5kc19hdCI6IjIwMTgtMDctMjZUMTk6MDA6MDAuMDAwMDAwIn19fQ.T6uHXuq-lgUOhxgQudGMhYTaVrQMCsuq5P3JOxEF0BwLbhYZpi04Eaz4-F3ByCYhDyAZnrekcMz-maJtJz5R_HL4RLlB8tzNR22QFYVqYJtMvVMUJYDg96qfZ1buoXHit7DGcYgz2QX5CGYFGNMjTwe4WO1X1gBT746GabadVxuKwvTyCJWMX58UcAyYxzgQfDjdp-tZO8mcCdHOzCaP_d0099LMYMY_7P5NnyrlZrOziZH0WGtYUqqew1xeEu51uC2jEV6bhuCX42Wj4bz6q7qiETOfX1KaOxBBe5VkYUvBtBBdfKn5g10ZDCwrsINsCVVhuXdIW8kzPl5vfbWQTw
                        price: 19
                        tax: 6.78
                    - items:
                        - external_item_id: Item_2226
                          product_id: '1000081'
                          price:
                            item_price: 36.74
                            item_list_price: 36.74
                            item_tax_lines:
                              - amount: 2.93
                                rate: 0.0625
                                name: Custom Tax
                                country_code: US
                            item_discount_info: []
                            item_order_discount_info:
                              - description: >-
                                  Discount for mismatch value between order
                                  total and paid total from Shopify
                                discount_ref: Mismatch value from Shopify
                                coupon_code: Mismatch value from Shopify
                                price_adjustment: 4.11
                                type: fixed
                                original_value: 4.11
                            pricebook: default
                          extended_attributes:
                            - name: item-level
                              value: attribute
                      shipping_option:
                        shipping_offer_token: eyJhbGciOiJSUzI1NiITAxMTcifQ.diM4BObG
                        price: 0
                        tax: 0
                  payments:
                    - processor: adyen
                      correlation_ref: ch_1DIsE9GMCeo3G7b40EbEjfZX
                      type: captured
                      amount: 103.71
                      method: credit_card
                      processed_at: '2018-10-08T07:06:08.067Z'
                  price_method: tax_excluded
              prerouted_order:
                summary: Prerouted order
                description: |
                  With a fulfillment location provided in the shipment.
                value:
                  external_id: EXT19010006103trttSrSSS
                  placed_at: '2018-10-08T07:06:08.067Z'
                  shop: storefront-catalog-en
                  store_id: 807b05a4-5554-5302-a67f-aa3293107e92
                  associate_id: 3045c2140d2e4a5ba0f2ddc0a27d8798
                  channel_type: mobile
                  channel_name: retailer android app
                  currency: USD
                  customer_name: Jay Doubleyou
                  customer_email: jw@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: CON0962868711
                  notification_blacklist:
                    - invoice_created
                    - refund_note_created
                  shipping_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    address_line_2: ''
                    phone: 987654321
                  billing_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  shipments:
                    - items:
                        - external_item_id: EXT19010006103trttSrSSS
                          product_id: '1000001'
                          price:
                            item_price: 10
                            item_list_price: 10
                            item_tax_lines:
                              - amount: 0.63
                                rate: 0.0625
                                name: Custom Tax
                                country_code: US
                            pricebook: default
                          extended_attributes:
                            - name: item-level
                              value: attribute
                      shipping_option:
                        service_level_identifier: GROUND
                        price: 20
                        tax: 6.78
                        routing_strategy:
                          strategy: prerouted
                          fulfillment_node_id: US01
                  payments:
                    - processor: stripe
                      correlation_ref: ch_1DIsE9GMCeo3G7b40EbEjfZX
                      type: captured
                      amount: 30
                      method: credit_card
                      processed_at: '2018-10-08T07:06:08.067Z'
                      metadata:
                        transaction_id: TR_ASDF000014
                        token: TOK_ASDFQWE123
                        last_digits: '9999'
                        expiration_year: '2018'
                        expiration_month: '05'
                        name: Jay Doubleyou
                        brand: Visa
                  price_method: tax_included
              historical_order:
                summary: Historical order
                description: >
                  From an e-commerce system with a credit card payment via Adyen
                  and notifications suppressed.
                value:
                  external_id: INJECTED_historical-123456
                  placed_at: '2018-10-08T07:06:08.067Z'
                  is_historical: true
                  shop: store-catalog-en
                  store_id: 024848c9-909b-4f02-b220-cc50777ce734
                  associate_id: b3b69dc61d4b422aaa1d433bd80d8d8f
                  channel_type: web
                  channel_name: shopify
                  currency: USD
                  customer_name: Jay Doubleyou
                  customer_email: jw@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: CON0962868711
                  notification_blacklist:
                    - invoice_created
                    - refund_note_created
                    - order_pending
                    - shipment_cancelled
                    - shipment_dispatched
                    - shipment_delayed
                    - order_cancelled
                    - in_store.ready_for_pick_up
                  shipping_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  billing_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  shipments:
                    - items:
                        - external_item_id: EXT1000761
                          product_id: '1000761'
                          price:
                            item_price: 50
                            item_list_price: 50
                            item_tax_lines:
                              - amount: 13
                                rate: 0.0758
                                name: Custom Tax
                                country_code: US
                      historical_shipping_option:
                        service_level_identifier: GROUND_HOME_DELIVERY
                        display_name: Ground
                        shipping_type: traditional_carrier
                        fulfillment_node_id: US01
                        shipping_carrier: FEDEX
                        zip_code: '02211'
                        country_code: US
                        price: 19
                        tax: 6.78
                      shipped_at: '2018-10-08T07:06:08.067Z'
                  payments:
                    - processor: stripe
                      correlation_ref: ch_1DIsE9GMCeo3G7b40EbEjfZX
                      type: captured
                      amount: 88.78
                      method: credit_card
                      processed_at: '2018-10-08T07:06:08.067Z'
                      metadata:
                        transaction_id: TR_ASDF000014
                        token: TOK_ASDFQWE123
                        last_digits: '9999'
                        expiration_year: '2018'
                        expiration_month: '05'
                        name: John Doe
                        brand: Visa
                  price_method: tax_excluded
              historical_order_pos:
                summary: Historical order from a POS system
                description: >
                  From a POS system for an in-store purchase with a cash
                  payment.
                value:
                  external_id: INJECTED_historical-123456
                  placed_at: '2018-10-08T07:06:08.067Z'
                  is_historical: true
                  is_fulfilled: true
                  shop: store-catalog-en
                  store_id: 024848c9-909b-4f02-b220-cc50777ce734
                  associate_id: b3b69dc61d4b422aaa1d433bd80d8d8f
                  channel_type: web
                  channel_name: shopify
                  currency: USD
                  customer_name: Jay Doubleyou
                  customer_email: jw@example.com
                  shop_locale: en-US
                  customer_language: EN
                  external_customer_id: CON0962868711
                  notification_blacklist:
                    - invoice_created
                    - refund_note_created
                    - order_pending
                    - shipment_cancelled
                    - shipment_dispatched
                    - shipment_delayed
                    - order_cancelled
                    - in_store.ready_for_pick_up
                  billing_address:
                    first_name: Jay
                    last_name: Doubleyou
                    country: US
                    zip_code: '02111'
                    city: Boston
                    state: Massachusetts
                    address_line_1: 601 South Street
                    phone: 202-555-0140
                  shipments:
                    - items:
                        - external_item_id: EXT1000761
                          product_id: '1000761'
                          price:
                            item_price: 98
                            item_list_price: 98
                            item_tax_lines:
                              - amount: 0
                                rate: 0
                                name: Custom Tax
                                country_code: US
                      historical_shipping_option:
                        service_level_identifier: IN_STORE_HANDOVER
                        display_name: In store
                        shipping_type: in_store_handover
                        fulfillment_node_id: US01
                        shipping_carrier: in_store_handover
                        zip_code: '02211'
                        country_code: US
                        price: 98
                        tax: 0
                      shipped_at: '2018-10-08T07:06:08.067Z'
                  payments:
                    - processor: pos_order
                      correlation_ref: ch_1DIsE9GMCeo3G7b40EbEjfZX
                      type: captured
                      amount: 98
                      method: cash
                      processed_at: '2018-10-08T07:06:08.067Z'
                  price_method: tax_excluded
            schema:
              required:
                - external_id
                - shop
                - shop_locale
                - channel_type
                - channel_name
                - currency
                - shipments
              properties:
                external_id:
                  type: string
                  minLength: 1
                  maxLength: 64
                shop:
                  type: string
                  description: The shop containing the items of the order.
                  minLength: 1
                  maxLength: 128
                channel_type:
                  type: string
                  enum:
                    - web
                    - mobile
                    - store
                channel_name:
                  description: >-
                    A string used to distinguish between various sources of
                    orders.
                  type: string
                  minLength: 1
                  maxLength: 64
                store_id:
                  type: string
                  description: ID of the store where this order was placed.
                  maxLength: 256
                associate_id:
                  type: string
                  description: ID of the store associate who processed this order.
                  maxLength: 256
                customer_name:
                  type: string
                  minLength: 1
                  maxLength: 128
                customer_email:
                  type: string
                  minLength: 1
                  maxLength: 64
                shop_locale:
                  type: string
                  description: The locale of the customer used for the shop, in RFC 5646.
                  minLength: 1
                  maxLength: 128
                customer_language:
                  description: >-
                    Language code according to ISO 639-1 to be used in the
                    communication with the consumer (e.g. 'de', 'en' or 'fr')
                  type: string
                  maxLength: 2
                external_customer_id:
                  type: string
                  maxLength: 64
                placed_at:
                  type: string
                  description: >-
                    Date representation of when the order was placed, containing
                    date, time and timezone as defined by
                    https://tools.ietf.org/html/rfc3339 (ISO 8601).
                  format: date-time
                ip_address:
                  oneOf:
                    - type: string
                      format: ipv4
                    - type: string
                      format: ipv6
                shipping_address:
                  type: object
                  required:
                    - country
                    - address_line_1
                  properties:
                    title:
                      type: string
                      maxLength: 32
                    suffix:
                      type: string
                      maxLength: 32
                    salutation:
                      type: string
                      maxLength: 32
                    first_name:
                      type: string
                      maxLength: 64
                    last_name:
                      type: string
                      maxLength: 64
                    country:
                      description: The code of the country in the ISO ALPHA-2 format.
                      type: string
                      minLength: 2
                      maxLength: 2
                    zip_code:
                      type: string
                      maxLength: 32
                    city:
                      type: string
                      maxLength: 64
                    state:
                      type: string
                      maxLength: 32
                    address_line_1:
                      type: string
                      minLength: 1
                      maxLength: 128
                    address_line_2:
                      type: string
                      maxLength: 256
                    phone:
                      type: string
                      maxLength: 128
                shipments:
                  type: array
                  minItems: 1
                  maxItems: 5
                  items:
                    oneOf:
                      - type: object
                        description: A shipment sent from a fulfillment location.
                        required:
                          - shipping_option
                          - items
                        properties:
                          items:
                            type: array
                            minItems: 1
                            items:
                              type: object
                              description: >-
                                A single product. The quantity of the item is
                                always assumed to be 1 because products are
                                flat, and each variant of a product is
                                considered a separate item. The item is
                                identified by `external_item_id` in the external
                                system. In the response, an internal NewStore
                                item ID is returned for each `external_item_id`.
                              required:
                                - external_item_id
                                - product_id
                                - price
                              properties:
                                external_item_id:
                                  type: string
                                  minLength: 1
                                  maxLength: 64
                                product_id:
                                  type: string
                                  description: >-
                                    The identifier of the product as it was
                                    fetched from the catalog.
                                  minLength: 1
                                  maxLength: 64
                                price:
                                  type: object
                                  required:
                                    - item_price
                                    - item_list_price
                                    - item_tax_lines
                                  properties:
                                    item_price:
                                      description: >-
                                        Price of the item, including taxes or
                                        not, depending on the value of the
                                        `price_method` property. Can be affected
                                        by pricebooks and bundle pricing.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_list_price:
                                      description: Price from the default pricebook.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_tax_lines:
                                      description: Describes the taxes applied to the item.
                                      type: array
                                      minItems: 0
                                      maxItems: 100
                                      items:
                                        type: object
                                        required:
                                          - amount
                                          - name
                                          - rate
                                        properties:
                                          amount:
                                            type: number
                                            description: The tax amount.
                                            multipleOf: 0.01
                                            minimum: 0
                                          rate:
                                            type: number
                                            description: >-
                                              The tax rate. Must be in form of ratio
                                              between 0 and 1, not percentage.
                                            minimum: 0
                                          name:
                                            type: string
                                            description: A description of the tax type. Required.
                                          country_code:
                                            description: >-
                                              The code of the country of the tax in
                                              the ISO 3166 ALPHA-2 format. For
                                              example, GB, DE or US.
                                            type: string
                                            maxLength: 2
                                    item_discount_info:
                                      type: array
                                      description: >-
                                        Information about item-level discounts
                                        applied to the items.
                                      maxItems: 1
                                      items:
                                        oneOf:
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - fixed
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                type: number
                                                multipleOf: 0.01
                                                minimum: 0
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - percentage
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                                maximum: 100
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                multipleOf: 0.01
                                                type: number
                                                minimum: 0
                                        type: object
                                        required:
                                          - discount_ref
                                          - type
                                          - original_value
                                          - price_adjustment
                                    item_order_discount_info:
                                      type: array
                                      description: >-
                                        Information about order-level discounts
                                        applied to the item. An order level
                                        discount is prorated for all the items
                                        across all shipments.
                                      maxItems: 1
                                      items:
                                        oneOf:
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - fixed
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                type: number
                                                multipleOf: 0.01
                                                minimum: 0
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - percentage
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                                maximum: 100
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                multipleOf: 0.01
                                                type: number
                                                minimum: 0
                                        type: object
                                        required:
                                          - discount_ref
                                          - type
                                          - original_value
                                          - price_adjustment
                                    pricebook:
                                      description: >-
                                        A reference to the pricebook used to
                                        calculate the catalog price.
                                      type: string
                                      default: default
                                      maxLength: 64
                                    group_ref:
                                      type: string
                                      description: >-
                                        A reference to a group (bundle) if group
                                        pricing was used for the item.
                                      maxLength: 64
                                gift_wrapping:
                                  type: object
                                  description: >-
                                    Indicates if gift wrapping option was
                                    selected for the order. Only information
                                    from the first item (message and price) will
                                    be taken into account.
                                  properties:
                                    message:
                                      description: >-
                                        Message to be attached to the
                                        gift-wrapped order. Its length is
                                        configurable per tenant.
                                      type: string
                                      maxLength: 512
                                    item_price:
                                      description: >-
                                        Price of the item, including taxes or
                                        not, depending on the value of the
                                        `price_method` property.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_tax_lines:
                                      description: Describes the taxes applied to the item.
                                      type: array
                                      minItems: 0
                                      maxItems: 100
                                      items:
                                        type: object
                                        required:
                                          - amount
                                          - name
                                          - rate
                                        properties:
                                          amount:
                                            type: number
                                            description: The tax amount.
                                            multipleOf: 0.01
                                            minimum: 0
                                          rate:
                                            type: number
                                            description: >-
                                              The tax rate. Must be in form of ratio
                                              between 0 and 1, not percentage.
                                            minimum: 0
                                          name:
                                            type: string
                                            description: A description of the tax type. Required.
                                          country_code:
                                            description: >-
                                              The code of the country of the tax in
                                              the ISO 3166 ALPHA-2 format. For
                                              example, GB, DE or US.
                                            type: string
                                            maxLength: 2
                                    tax_class:
                                      description: >-
                                        Tax classification identifier for the
                                        line item
                                      type: string
                                      maxLength: 256
                                extended_attributes:
                                  type: array
                                  maxItems: 100
                                  items:
                                    type: object
                                    required:
                                      - name
                                      - value
                                    description: >-
                                      Extra information about the order, which
                                      is propagated through NewStore
                                      applications.
                                    maxProperties: 2
                                    properties:
                                      name:
                                        type: string
                                        minLength: 1
                                        maxLength: 100
                                      value:
                                        type: string
                                        maxLength: 8192
                          shipping_option:
                            oneOf:
                              - type: object
                                required:
                                  - service_level_identifier
                                  - price
                                  - tax
                                properties:
                                  service_level_identifier:
                                    description: >-
                                      Service level identifier of the shipping
                                      option. Set it to IN_STORE_HANDOVER in
                                      case of injecting an in-store purchase
                                      order. The order will be soft-routed on
                                      injection unless config
                                      order_injection/skip_soft_routing_on_injection
                                      is enabled. Note that this option will NOT
                                      work if there are multiple shipments. In
                                      which case, use the other payload that
                                      requires a shipping option token.
                                    type: string
                                    minLength: 1
                                    maxLength: 64
                                  price:
                                    type: number
                                    description: >-
                                      The price of the shipping option before
                                      discounts. It might include taxes
                                      depending on the tax method and the
                                      `price_method` property.
                                    minimum: 0
                                  tax:
                                    type: number
                                    description: The tax applied to the shipping option.
                                    minimum: 0
                                  discount_info:
                                    type: array
                                    description: >-
                                      Information about shipping discounts
                                      applied to the shipment.
                                    maxItems: 1
                                    items:
                                      oneOf:
                                        - properties:
                                            discount_ref:
                                              type: string
                                              description: >-
                                                A string token identifying the discount,
                                                e.g. BLACK_FRIDAY_SALE.
                                              minLength: 1
                                              maxLength: 256
                                            coupon_code:
                                              type: string
                                              maxLength: 64
                                            description:
                                              type: string
                                              maxLength: 1024
                                            type:
                                              type: string
                                              enum:
                                                - fixed
                                            original_value:
                                              description: >-
                                                Discount applied. In the case of an
                                                item_discount_info, the discount is
                                                applied to the item itself. In the case
                                                of an item_order_discount_info, the
                                                discount is applied to the whole order.
                                              type: number
                                              minimum: 0
                                            price_adjustment:
                                              description: >-
                                                Monetary discount amount applied to the
                                                current item.
                                              type: number
                                              multipleOf: 0.01
                                              minimum: 0
                                        - properties:
                                            discount_ref:
                                              type: string
                                              description: >-
                                                A string token identifying the discount,
                                                e.g. BLACK_FRIDAY_SALE.
                                              minLength: 1
                                              maxLength: 256
                                            coupon_code:
                                              type: string
                                              maxLength: 64
                                            description:
                                              type: string
                                              maxLength: 1024
                                            type:
                                              type: string
                                              enum:
                                                - percentage
                                            original_value:
                                              description: >-
                                                Discount applied. In the case of an
                                                item_discount_info, the discount is
                                                applied to the item itself. In the case
                                                of an item_order_discount_info, the
                                                discount is applied to the whole order.
                                              type: number
                                              minimum: 0
                                              maximum: 100
                                            price_adjustment:
                                              description: >-
                                                Monetary discount amount applied to the
                                                current item.
                                              multipleOf: 0.01
                                              type: number
                                              minimum: 0
                                      type: object
                                      required:
                                        - discount_ref
                                        - type
                                        - original_value
                                        - price_adjustment
                                  routing_strategy:
                                    description: >-
                                      The strategy used to route the order. If
                                      no value is specified, the default
                                      strategy is used and the order is routed
                                      to the best location based on the
                                      fulfillment configuration.
                                    oneOf:
                                      - type: object
                                        required:
                                          - strategy
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - default
                                            description: >-
                                              The default routing strategy that
                                              NewStore uses to determine the best
                                              fulfillment location, based on the
                                              fulfillment config.
                                      - type: object
                                        required:
                                          - strategy
                                          - fulfillment_node_id
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - prerouted
                                            description: >-
                                              The routing strategy used to specify the
                                              fulfillment location for the order, and
                                              prevent it from being routed based on
                                              the fulfillment config.
                                          fulfillment_node_id:
                                            description: >-
                                              The fulfillment node ID to which the
                                              order is going to be routed. The
                                              location must have ATP for all items in
                                              the order. If there's no ATP for some
                                              items, the items are put [on
                                              hold](/docs/nomapp/nom-monitor-orders.html#managing-on-hold-orders).
                                            type: string
                                            minLength: 1
                                            maxLength: 256
                                      - type: object
                                        required:
                                          - strategy
                                          - fulfillment_node_id
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - external
                                            description: >-
                                              This routing strategy is used to fulfill
                                              a order routed by an external OMS. If
                                              the `external` strategy is used, the
                                              `fulfillment_node_id` and the
                                              `service_level` from the
                                              `shipping_option` is required.
                                          fulfillment_node_id:
                                            description: >-
                                              The fulfillment node ID to which the
                                              order will be routed. This location must
                                              exist in NewStore, otherwise the order
                                              will be canceled.
                                            type: string
                                            minLength: 1
                                            maxLength: 256
                              - type: object
                                required:
                                  - shipping_offer_token
                                  - price
                                  - tax
                                properties:
                                  shipping_offer_token:
                                    type: string
                                    minLength: 1
                                    maxLength: 8192
                                    description: >-
                                      The shipping option token
                                      ('shipping_offer_token') obtained from the
                                      [Get routing options
                                      method](https://docs.newstore.net/newstore-cloud/catalog/sfcc-integration.html#tag/Checkout-Options).
                                  price:
                                    type: number
                                    description: >-
                                      The price of the shipping option before
                                      discounts. It might include taxes
                                      depending on the tax method.
                                    minimum: 0
                                  tax:
                                    type: number
                                    description: The tax applied to the shipping option.
                                    minimum: 0
                                  discount_info:
                                    type: array
                                    description: >-
                                      Information about shipping discounts
                                      applied to the shipment.
                                    maxItems: 1
                                    items:
                                      oneOf:
                                        - properties:
                                            discount_ref:
                                              type: string
                                              description: >-
                                                A string token identifying the discount,
                                                e.g. BLACK_FRIDAY_SALE.
                                              minLength: 1
                                              maxLength: 256
                                            coupon_code:
                                              type: string
                                              maxLength: 64
                                            description:
                                              type: string
                                              maxLength: 1024
                                            type:
                                              type: string
                                              enum:
                                                - fixed
                                            original_value:
                                              description: >-
                                                Discount applied. In the case of an
                                                item_discount_info, the discount is
                                                applied to the item itself. In the case
                                                of an item_order_discount_info, the
                                                discount is applied to the whole order.
                                              type: number
                                              minimum: 0
                                            price_adjustment:
                                              description: >-
                                                Monetary discount amount applied to the
                                                current item.
                                              type: number
                                              multipleOf: 0.01
                                              minimum: 0
                                        - properties:
                                            discount_ref:
                                              type: string
                                              description: >-
                                                A string token identifying the discount,
                                                e.g. BLACK_FRIDAY_SALE.
                                              minLength: 1
                                              maxLength: 256
                                            coupon_code:
                                              type: string
                                              maxLength: 64
                                            description:
                                              type: string
                                              maxLength: 1024
                                            type:
                                              type: string
                                              enum:
                                                - percentage
                                            original_value:
                                              description: >-
                                                Discount applied. In the case of an
                                                item_discount_info, the discount is
                                                applied to the item itself. In the case
                                                of an item_order_discount_info, the
                                                discount is applied to the whole order.
                                              type: number
                                              minimum: 0
                                              maximum: 100
                                            price_adjustment:
                                              description: >-
                                                Monetary discount amount applied to the
                                                current item.
                                              multipleOf: 0.01
                                              type: number
                                              minimum: 0
                                      type: object
                                      required:
                                        - discount_ref
                                        - type
                                        - original_value
                                        - price_adjustment
                                  routing_strategy:
                                    description: >-
                                      The strategy used to route the order. If
                                      no value is specified, the default
                                      strategy is used and the order is routed
                                      to the best location based on the
                                      fulfillment configuration.
                                    oneOf:
                                      - type: object
                                        required:
                                          - strategy
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - default
                                            description: >-
                                              The default routing strategy that
                                              NewStore uses to determine the best
                                              fulfillment location, based on the
                                              fulfillment config.
                                      - type: object
                                        required:
                                          - strategy
                                          - fulfillment_node_id
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - prerouted
                                            description: >-
                                              The routing strategy used to specify the
                                              fulfillment location for the order, and
                                              prevent it from being routed based on
                                              the fulfillment config.
                                          fulfillment_node_id:
                                            description: >-
                                              The fulfillment node ID to which the
                                              order is going to be routed. The
                                              location must have ATP for all items in
                                              the order. If there's no ATP for some
                                              items, the items are put [on
                                              hold](/docs/nomapp/nom-monitor-orders.html#managing-on-hold-orders).
                                            type: string
                                            minLength: 1
                                            maxLength: 256
                                      - type: object
                                        required:
                                          - strategy
                                          - fulfillment_node_id
                                        properties:
                                          strategy:
                                            type: string
                                            enum:
                                              - external
                                            description: >-
                                              This routing strategy is used to fulfill
                                              a order routed by an external OMS. If
                                              the `external` strategy is used, the
                                              `fulfillment_node_id` and the
                                              `service_level` from the
                                              `shipping_option` is required.
                                          fulfillment_node_id:
                                            description: >-
                                              The fulfillment node ID to which the
                                              order will be routed. This location must
                                              exist in NewStore, otherwise the order
                                              will be canceled.
                                            type: string
                                            minLength: 1
                                            maxLength: 256
                      - type: object
                        description: >-
                          Shipment of a historical order that has already been
                          shipped from a fulfillment location. A historical
                          order represents an already completed order that was
                          imported from an external system, into NewStore.
                        required:
                          - historical_shipping_option
                          - items
                        properties:
                          items:
                            type: array
                            minItems: 1
                            items:
                              type: object
                              description: >-
                                A single product. The quantity of the item is
                                always assumed to be 1 because products are
                                flat, and each variant of a product is
                                considered a separate item. The item is
                                identified by `external_item_id` in the external
                                system. In the response, an internal NewStore
                                item ID is returned for each `external_item_id`.
                              required:
                                - external_item_id
                                - product_id
                                - price
                              properties:
                                external_item_id:
                                  type: string
                                  minLength: 1
                                  maxLength: 64
                                product_id:
                                  type: string
                                  description: >-
                                    The identifier of the product as it was
                                    fetched from the catalog.
                                  minLength: 1
                                  maxLength: 64
                                price:
                                  type: object
                                  required:
                                    - item_price
                                    - item_list_price
                                    - item_tax_lines
                                  properties:
                                    item_price:
                                      description: >-
                                        Price of the item, including taxes or
                                        not, depending on the value of the
                                        `price_method` property. Can be affected
                                        by pricebooks and bundle pricing.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_list_price:
                                      description: Price from the default pricebook.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_tax_lines:
                                      description: Describes the taxes applied to the item.
                                      type: array
                                      minItems: 0
                                      maxItems: 100
                                      items:
                                        type: object
                                        required:
                                          - amount
                                          - name
                                          - rate
                                        properties:
                                          amount:
                                            type: number
                                            description: The tax amount.
                                            multipleOf: 0.01
                                            minimum: 0
                                          rate:
                                            type: number
                                            description: >-
                                              The tax rate. Must be in form of ratio
                                              between 0 and 1, not percentage.
                                            minimum: 0
                                          name:
                                            type: string
                                            description: A description of the tax type. Required.
                                          country_code:
                                            description: >-
                                              The code of the country of the tax in
                                              the ISO 3166 ALPHA-2 format. For
                                              example, GB, DE or US.
                                            type: string
                                            maxLength: 2
                                    item_discount_info:
                                      type: array
                                      description: >-
                                        Information about item-level discounts
                                        applied to the items.
                                      maxItems: 1
                                      items:
                                        oneOf:
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - fixed
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                type: number
                                                multipleOf: 0.01
                                                minimum: 0
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - percentage
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                                maximum: 100
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                multipleOf: 0.01
                                                type: number
                                                minimum: 0
                                        type: object
                                        required:
                                          - discount_ref
                                          - type
                                          - original_value
                                          - price_adjustment
                                    item_order_discount_info:
                                      type: array
                                      description: >-
                                        Information about order-level discounts
                                        applied to the item. An order level
                                        discount is prorated for all the items
                                        across all shipments.
                                      maxItems: 1
                                      items:
                                        oneOf:
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - fixed
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                type: number
                                                multipleOf: 0.01
                                                minimum: 0
                                          - properties:
                                              discount_ref:
                                                type: string
                                                description: >-
                                                  A string token identifying the discount,
                                                  e.g. BLACK_FRIDAY_SALE.
                                                minLength: 1
                                                maxLength: 256
                                              coupon_code:
                                                type: string
                                                maxLength: 64
                                              description:
                                                type: string
                                                maxLength: 1024
                                              type:
                                                type: string
                                                enum:
                                                  - percentage
                                              original_value:
                                                description: >-
                                                  Discount applied. In the case of an
                                                  item_discount_info, the discount is
                                                  applied to the item itself. In the case
                                                  of an item_order_discount_info, the
                                                  discount is applied to the whole order.
                                                type: number
                                                minimum: 0
                                                maximum: 100
                                              price_adjustment:
                                                description: >-
                                                  Monetary discount amount applied to the
                                                  current item.
                                                multipleOf: 0.01
                                                type: number
                                                minimum: 0
                                        type: object
                                        required:
                                          - discount_ref
                                          - type
                                          - original_value
                                          - price_adjustment
                                    pricebook:
                                      description: >-
                                        A reference to the pricebook used to
                                        calculate the catalog price.
                                      type: string
                                      default: default
                                      maxLength: 64
                                    group_ref:
                                      type: string
                                      description: >-
                                        A reference to a group (bundle) if group
                                        pricing was used for the item.
                                      maxLength: 64
                                gift_wrapping:
                                  type: object
                                  description: >-
                                    Indicates if gift wrapping option was
                                    selected for the order. Only information
                                    from the first item (message and price) will
                                    be taken into account.
                                  properties:
                                    message:
                                      description: >-
                                        Message to be attached to the
                                        gift-wrapped order. Its length is
                                        configurable per tenant.
                                      type: string
                                      maxLength: 512
                                    item_price:
                                      description: >-
                                        Price of the item, including taxes or
                                        not, depending on the value of the
                                        `price_method` property.
                                      type: number
                                      multipleOf: 0.01
                                      minimum: 0
                                    item_tax_lines:
                                      description: Describes the taxes applied to the item.
                                      type: array
                                      minItems: 0
                                      maxItems: 100
                                      items:
                                        type: object
                                        required:
                                          - amount
                                          - name
                                          - rate
                                        properties:
                                          amount:
                                            type: number
                                            description: The tax amount.
                                            multipleOf: 0.01
                                            minimum: 0
                                          rate:
                                            type: number
                                            description: >-
                                              The tax rate. Must be in form of ratio
                                              between 0 and 1, not percentage.
                                            minimum: 0
                                          name:
                                            type: string
                                            description: A description of the tax type. Required.
                                          country_code:
                                            description: >-
                                              The code of the country of the tax in
                                              the ISO 3166 ALPHA-2 format. For
                                              example, GB, DE or US.
                                            type: string
                                            maxLength: 2
                                    tax_class:
                                      description: >-
                                        Tax classification identifier for the
                                        line item
                                      type: string
                                      maxLength: 256
                                extended_attributes:
                                  type: array
                                  maxItems: 100
                                  items:
                                    type: object
                                    required:
                                      - name
                                      - value
                                    description: >-
                                      Extra information about the order, which
                                      is propagated through NewStore
                                      applications.
                                    maxProperties: 2
                                    properties:
                                      name:
                                        type: string
                                        minLength: 1
                                        maxLength: 100
                                      value:
                                        type: string
                                        maxLength: 8192
                          historical_shipping_option:
                            properties:
                              service_level_identifier:
                                description: >-
                                  Service level identifier of the shipping
                                  option. Set it to IN_STORE_HANDOVER in case of
                                  injecting an in-store purchase order.
                                type: string
                                minLength: 1
                                maxLength: 64
                              shipping_type:
                                type: string
                                enum:
                                  - traditional_carrier
                                  - same_day_delivery
                                  - in_store_pick_up
                                  - in_store_handover
                                description: Shipping type.
                              store_id:
                                type: string
                                description: >-
                                  Identifier of the store preselected for that
                                  shipment. Required for in_store_pick_up and
                                  in_store_handover.
                              fulfillment_node_id:
                                type: string
                                description: >-
                                  Identifier of the fulfillment node preselected
                                  for that shipment.
                              shipping_carrier:
                                type: string
                                description: Shipping carrier code, e.g. 'USPS' or 'Deliv'.
                              display_name:
                                type: string
                                minLength: 1
                                description: Shipping option display name.
                              delivery_details:
                                type: string
                                description: >-
                                  Shipping option display details, in case of
                                  traditional carrier contains estimated
                                  delivery time.
                              price:
                                type: number
                                description: >-
                                  The price of the shipping option before
                                  discounts. It might include taxes depending on
                                  the tax method.
                                minimum: 0
                              tax:
                                type: number
                                description: The tax applied to the shipping option.
                                minimum: 0
                              discount_info:
                                type: array
                                description: >-
                                  Information about shipping discounts applied
                                  to the shipment.
                                maxItems: 1
                                items:
                                  oneOf:
                                    - properties:
                                        discount_ref:
                                          type: string
                                          description: >-
                                            A string token identifying the discount,
                                            e.g. BLACK_FRIDAY_SALE.
                                          minLength: 1
                                          maxLength: 256
                                        coupon_code:
                                          type: string
                                          maxLength: 64
                                        description:
                                          type: string
                                          maxLength: 1024
                                        type:
                                          type: string
                                          enum:
                                            - fixed
                                        original_value:
                                          description: >-
                                            Discount applied. In the case of an
                                            item_discount_info, the discount is
                                            applied to the item itself. In the case
                                            of an item_order_discount_info, the
                                            discount is applied to the whole order.
                                          type: number
                                          minimum: 0
                                        price_adjustment:
                                          description: >-
                                            Monetary discount amount applied to the
                                            current item.
                                          type: number
                                          multipleOf: 0.01
                                          minimum: 0
                                    - properties:
                                        discount_ref:
                                          type: string
                                          description: >-
                                            A string token identifying the discount,
                                            e.g. BLACK_FRIDAY_SALE.
                                          minLength: 1
                                          maxLength: 256
                                        coupon_code:
                                          type: string
                                          maxLength: 64
                                        description:
                                          type: string
                                          maxLength: 1024
                                        type:
                                          type: string
                                          enum:
                                            - percentage
                                        original_value:
                                          description: >-
                                            Discount applied. In the case of an
                                            item_discount_info, the discount is
                                            applied to the item itself. In the case
                                            of an item_order_discount_info, the
                                            discount is applied to the whole order.
                                          type: number
                                          minimum: 0
                                          maximum: 100
                                        price_adjustment:
                                          description: >-
                                            Monetary discount amount applied to the
                                            current item.
                                          multipleOf: 0.01
                                          type: number
                                          minimum: 0
                                  type: object
                                  required:
                                    - discount_ref
                                    - type
                                    - original_value
                                    - price_adjustment
                              zip_code:
                                description: Shipping origin zip code.
                                type: string
                              country_code:
                                type: string
                                description: >-
                                  Shipping origin country code. Must be
ISO-3166
                                  reference
.
                                enum:
                                  - AD
                                  - AE
                                  - AF
                                  - AG
                                  - AI
                                  - AL
                                  - AM
                                  - AO
                                  - AQ
                                  - AR
                                  - AS
                                  - AT
                                  - AU
                                  - AW
                                  - AX
                                  - AZ
                                  - BA
                                  - BB
                                  - BD
                                  - BE
                                  - BF
                                  - BG
                                  - BH
                                  - BI
                                  - BJ
                                  - BL
                                  - BM
                                  - BN
                                  - BO
                                  - BQ
                                  - BR
                                  - BS
                                  - BT
                                  - BV
                                  - BW
                                  - BY
                                  - BZ
                                  - CA
                                  - CC
                                  - CD
                                  - CF
                                  - CG
                                  - CH
                                  - CI
                                  - CK
                                  - CL
                                  - CM
                                  - CN
                                  - CO
                                  - CR
                                  - CU
                                  - CV
                                  - CW
                                  - CX
                                  - CY
                                  - CZ
                                  - DE
                                  - DJ
                                  - DK
                                  - DM
                                  - DO
                                  - DZ
                                  - EC
                                  - EE
                                  - EG
                                  - EH
                                  - ER
                                  - ES
                                  - ET
                                  - FI
                                  - FJ
                                  - FK
                                  - FM
                                  - FO
                                  - FR
                                  - GA
                                  - GB
                                  - GD
                                  - GE
                                  - GF
                                  - GG
                                  - GH
                                  - GI
                                  - GL
                                  - GM
                                  - GN
                                  - GP
                                  - GQ
                                  - GR
                                  - GS
                                  - GT
                                  - GU
                                  - GW
                                  - GY
                                  - HK
                                  - HM
                                  - HN
                                  - HR
                                  - HT
                                  - HU
                                  - ID
                                  - IE
                                  - IL
                                  - IM
                                  - IN
                                  - IO
                                  - IQ
                                  - IR
                                  - IS
                                  - IT
                                  - JE
                                  - JM
                                  - JO
                                  - JP
                                  - KE
                                  - KG
                                  - KH
                                  - KI
                                  - KM
                                  - KN
                                  - KP
                                  - KR
                                  - KW
                                  - KY
                                  - KZ
                                  - LA
                                  - LB
                                  - LC
                                  - LI
                                  - LK
                                  - LR
                                  - LS
                                  - LT
                                  - LU
                                  - LV
                                  - LY
                                  - MA
                                  - MC
                                  - MD
                                  - ME
                                  - MF
                                  - MG
                                  - MH
                                  - MK
                                  - ML
                                  - MM
                                  - MN
                                  - MO
                                  - MP
                                  - MQ
                                  - MR
                                  - MS
                                  - MT
                                  - MU
                                  - MV
                                  - MW
                                  - MX
                                  - MY
                                  - MZ
                                  - NA
                                  - NC
                                  - NE
                                  - NF
                                  - NG
                                  - NI
                                  - NL
                                  - 'NO'
                                  - NP
                                  - NR
                                  - NU
                                  - NZ
                                  - OM
                                  - PA
                                  - PE
                                  - PF
                                  - PG
                                  - PH
                                  - PK
                                  - PL
                                  - PM
                                  - PN
                                  - PR
                                  - PS
                                  - PT
                                  - PW
                                  - PY
                                  - QA
                                  - RE
                                  - RO
                                  - RS
                                  - RU
                                  - RW
                                  - SA
                                  - SB
                                  - SC
                                  - SD
                                  - SE
                                  - SG
                                  - SH
                                  - SI
                                  - SJ
                                  - SK
                                  - SL
                                  - SM
                                  - SN
                                  - SO
                                  - SR
                                  - SS
                                  - ST
                                  - SV
                                  - SX
                                  - SY
                                  - SZ
                                  - TC
                                  - TD
                                  - TF
                                  - TG
                                  - TH
                                  - TJ
                                  - TK
                                  - TL
                                  - TM
                                  - TN
                                  - TO
                                  - TR
                                  - TT
                                  - TV
                                  - TW
                                  - TZ
                                  - UA
                                  - UG
                                  - UM
                                  - US
                                  - UY
                                  - UZ
                                  - VA
                                  - VC
                                  - VE
                                  - VG
                                  - VI
                                  - VN
                                  - VU
                                  - WF
                                  - WS
                                  - YE
                                  - YT
                                  - ZA
                                  - ZM
                                  - ZW
                            type: object
                            required:
                              - service_level_identifier
                              - shipping_type
                              - fulfillment_node_id
                              - shipping_carrier
                              - display_name
                              - price
                              - tax
                              - zip_code
                              - country_code
                          shipped_at:
                            type: string
                            description: >-
                              Date representation of when the shipment was
                              shipped, containing date, time and timezone as
                              defined by https://tools.ietf.org/html/rfc3339
                              (ISO 8601). In case not provided, is set to
                              placed_at.
                            format: date-time
                extended_attributes:
                  type: array
                  maxItems: 100
                  items:
                    type: object
                    required:
                      - name
                      - value
                    description: >-
                      Extra information about the order, which is propagated
                      through NewStore applications.
                    maxProperties: 2
                    properties:
                      name:
                        type: string
                        minLength: 1
                        maxLength: 100
                      value:
                        type: string
                        maxLength: 8192
                billing_address:
                  type: object
                  required:
                    - country
                    - address_line_1
                  properties:
                    title:
                      type: string
                      maxLength: 32
                    suffix:
                      type: string
                      maxLength: 32
                    salutation:
                      type: string
                      maxLength: 32
                    first_name:
                      type: string
                      maxLength: 64
                    last_name:
                      type: string
                      maxLength: 64
                    country:
                      description: The code of the country in the ISO ALPHA-2 format.
                      type: string
                      minLength: 2
                      maxLength: 2
                    zip_code:
                      type: string
                      maxLength: 32
                    city:
                      type: string
                      maxLength: 64
                    state:
                      type: string
                      maxLength: 32
                    address_line_1:
                      type: string
                      minLength: 1
                      maxLength: 128
                    address_line_2:
                      type: string
                      maxLength: 256
                    phone:
                      type: string
                      maxLength: 128
                payments:
                  type: array
                  maxItems: 40
                  items:
                    description: >-
                      A payment supplied for this order. Only payments that are
                      already authorized or captured are supported. Tokens that
                      are not authorized are not supported. The validity of a
                      payment is not checked during import, so an order with
                      invalid payments is imported successfully and fulfilled.
                      For example, a payment validity issue can be a voided
                      authorization or an incorrect payment amount.
                    required:
                      - processor
                      - correlation_ref
                      - type
                      - amount
                      - method
                      - processed_at
                    properties:
                      type:
                        type: string
                        enum:
                          - authorized
                          - captured
                        description: >-
                          The type of payment information that is passed: either
                          the payment is already authorized, or already
                          captured. The Order Injection API does not support not
                          authorized payments (tokens).
                      amount:
                        type: number
                        minimum: 0
                        multipleOf: 0.01
                        exclusiveMinimum: true
                      method:
                        type: string
                        description: >-
                          The selected payment method. Typical values are
                          'cash', 'credit_card', 'gift_card', or 'paypal'. Other
                          values are possible depending on your payment
                          providers.
                        minLength: 1
                        maxLength: 64
                      wallet:
                        type: string
                        description: >-
                          The payment wallet used in the transaction. For
                          example, Apple Pay, Google Pay, etc. or Direct (when
                          no wallet was used).
                        minLength: 1
                        maxLength: 64
                      processed_at:
                        type: string
                        description: >-
                          Date representation of when the payment was processed,
                          containing date, time and timezone as defined by
                          https://tools.ietf.org/html/rfc3339 (ISO 8601).
                        format: date-time
                      metadata:
                        description: Payment method specific information.
                        maxProperties: 100
                        type: object
                      processor:
                        type: string
                        description: >-
                          Identifies the payment provider (processor) used to
                          process the payment. Supported providers are stripe,
                          paypal, cash, gift_card.
                        minLength: 1
                        maxLength: 32
                      correlation_ref:
                        type: string
                        description: >-
                          Identifies the payment for the given order among all
                          payments. This identifier must be unique in the given
                          order, regardless of the payment processor.
                        minLength: 1
                        maxLength: 128
                    type: object
                price_method:
                  type: string
                  description: >-
                    Specifies if the prices for the shipment items and shipping
                    options include tax or not. This is used in calculating the
                    total order price to determine if the tax price should be
                    included in the calculation or not.
                  enum:
                    - tax_included
                    - tax_excluded
                is_preconfirmed:
                  type: boolean
                  default: false
                  description: >-
                    Set to true, if the customer was already notified about
                    order being placed. This is always true for in-store orders.
                is_fulfilled:
                  type: boolean
                  default: false
                  description: >-
                    Set to true if the order was already fulfilled. It is either
                    an in-store purchase, or the order was fulfilled by an
                    external system.
                is_offline:
                  type: boolean
                  default: false
                  description: >-
                    Set to true if the order was handled offline. It is an
                    in-store purchase with internet connection failure.
                is_historical:
                  type: boolean
                  default: false
                  description: >-
                    Set to true if the order is historical was created and
                    fulfilled by an external system.
                notification_blacklist:
                  type: array
                  items:
                    type: string
                    description: >-
                      The notification name. Each notification name included
                      here must be an exact match of the name used in the
                      notification configuration.
                    example: same_day_delivery.estimate_changed
                  description: >-
                    Excludes the specified notifications from being sent to the
                    customer.
                currency:
                  description: >-
                    The currency for all the prices contained within this
                    payload.
                  type: string
                  enum:
                    - AED
                    - AFN
                    - ALL
                    - AMD
                    - ANG
                    - AOA
                    - ARS
                    - AUD
                    - AWG
                    - AZN
                    - BAM
                    - BBD
                    - BDT
                    - BGN
                    - BHD
                    - BIF
                    - BMD
                    - BND
                    - BOB
                    - BOV
                    - BRL
                    - BSD
                    - BTN
                    - BWP
                    - BYN
                    - BZD
                    - CAD
                    - CDF
                    - CHE
                    - CHF
                    - CHW
                    - CLF
                    - CLP
                    - CNY
                    - COP
                    - COU
                    - CRC
                    - CUC
                    - CUP
                    - CVE
                    - CZK
                    - DJF
                    - DKK
                    - DOP
                    - DZD
                    - EGP
                    - ERN
                    - ETB
                    - EUR
                    - FJD
                    - FKP
                    - GBP
                    - GEL
                    - GHS
                    - GIP
                    - GMD
                    - GNF
                    - GTQ
                    - GYD
                    - HKD
                    - HNL
                    - HRK
                    - HTG
                    - HUF
                    - IDR
                    - ILS
                    - INR
                    - IQD
                    - IRR
                    - ISK
                    - JMD
                    - JOD
                    - JPY
                    - KES
                    - KGS
                    - KHR
                    - KMF
                    - KPW
                    - KRW
                    - KWD
                    - KYD
                    - KZT
                    - LAK
                    - LBP
                    - LKR
                    - LRD
                    - LSL
                    - LYD
                    - MAD
                    - MDL
                    - MGA
                    - MKD
                    - MMK
                    - MNT
                    - MOP
                    - MRU
                    - MUR
                    - MVR
                    - MWK
                    - MXN
                    - MXV
                    - MYR
                    - MZN
                    - NAD
                    - NGN
                    - NIO
                    - NOK
                    - NPR
                    - NZD
                    - OMR
                    - PAB
                    - PEN
                    - PGK
                    - PHP
                    - PKR
                    - PLN
                    - PYG
                    - QAR
                    - RON
                    - RSD
                    - RUB
                    - RWF
                    - SAR
                    - SBD
                    - SCR
                    - SDG
                    - SEK
                    - SGD
                    - SHP
                    - SLL
                    - SOS
                    - SRD
                    - SSP
                    - STN
                    - SVC
                    - SYP
                    - SZL
                    - THB
                    - TJS
                    - TMT
                    - TND
                    - TOP
                    - TRY
                    - TTD
                    - TWD
                    - TZS
                    - UAH
                    - UGX
                    - USD
                    - USN
                    - UYI
                    - UYU
                    - UYW
                    - UZS
                    - VES
                    - VND
                    - VUV
                    - WST
                    - XAF
                    - XAG
                    - XAU
                    - XBA
                    - XBB
                    - XBC
                    - XBD
                    - XCD
                    - XDR
                    - XOF
                    - XPD
                    - XPF
                    - XPT
                    - XSU
                    - XTS
                    - XUA
                    - XXX
                    - YER
                    - ZAR
                    - ZMW
                    - ZWL
              type: object
              description: >-
                An order placed in an external system, identified by its
                `external_id` in NewStore. An order contains a list of shipments
                and the products in each shipment.
        required: true
components:
  schemas: {}
  responses: {}
  parameters: {}
  examples: {}
  requestBodies: {}
  headers: {}
  securitySchemes:
    newStoreAccessToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
  links: {}
  callbacks: {}