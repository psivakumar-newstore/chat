openapi: 3.0.0
info:
  title: Coupons API
  version: v0
  description: >
    Use this API to manage [coupons](/docs/glossary.html#term-coupon) that can
    be used by the

    customer during checkout, and coupon definitions, which are used to generate
    these coupons.


    To learn how to create coupons, see the
    [guide](/docs/development/api/guides/coupons.html).
servers:
  - url: https://dodici.x.newstore.net/v0/d
tags:
  - name: Coupon definitions
    description: >
      Represents a coupon definition from which coupons are generated. A coupon
      definition,

      is based on a
      [discount](/newstore-cloud/discounts_and_coupons/promotion.html).


      To learn how to create them, refer to the [Coupons
      tutorial](/docs/development/api/guides/coupons.html).
  - name: Coupons
    description: >
      Represents a coupon that can be used by the customer during checkout.

      It is created from a [coupon definition](#tag/Coupon-definitions).


      To learn how to create them, refer to this
      [guide](/docs/development/api/guides/coupons.html).
  - name: Coupon templates
    description: |
      Represents a coupon template that can be used to create coupons.
paths:
  /coupon_definitions:
    post:
      tags:
        - Coupon definitions
      summary: Create coupon definition
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon definition was successfully created.
          content:
            application/json:
              example:
                schema:
                  id: c4c429fc-9744-41ea-87a0-e081092d63f9
                  label: cybermon679
              schema:
                type: object
                required:
                  - id
                  - label
                properties:
                  id:
                    type: string
                    description: >-
                      The coupon definition ID generated by NewStore. This is
                      just exposed for tracing reasons. To create a coupon, use
                      the 'label' property of the definition.
                  label:
                    type: string
                    description: >-
                      The provided definition label. Use this label to create
                      coupons using the '/coupon_definitions POST' method.
        '400':
          description: Something was wrong with the request.
      description: |
        Creates a coupon definition, which is used to create coupons using the
        [Create coupon](#operation/CreateCoupon) method.
      operationId: CreateCouponDefinition
      requestBody:
        content:
          application/json:
            example:
              coupondef_req_date:
                schema:
                  pattern: coupondef-[A-Z]{3}[0-9]{3}
                  validation_rules:
                    - label: valid_from
                      values:
                        valid_from: '2017-10-23T06:00:00.000Z'
                    - label: valid_to
                      values:
                        valid_to: '2019-11-30T23:59:59.000Z'
                  label: cybermon678
                  discount_rule_id: f32f4cf6-f65d-4ed9-be4c-26a2b0552a51
                  max_redemptions: 10000000
              coupondef_req_customer:
                schema:
                  pattern: coupondef-[A-Z]{3}[0-9]{3}
                  validation_rules:
                    - label: restricted_to_consumer_id
                      values:
                        consumer_id: 8de1d881-2572-4848-b3f7-e8cb9a45b4f5
                  label: loyalty
                  discount_rule_id: 48f5c1d4-b34b-4e5e-a16e-6941acb8f8fe
                  max_redemptions: 1
            schema:
              title: Create coupon definition request
              type: object
              description: >-
                A definition is required to create a coupon. Some of the
                properties set in the definition can be overwritten by the
                coupon itself at coupon creation time.
              required:
                - label
                - pattern
                - discount_rule_id
              properties:
                label:
                  type: string
                  description: >-
                    Label to identify the coupon definition by. Must be unique,
                    second call with the same label will fail.
                  minLength: 1
                pattern:
                  type: string
                  description: RegEx pattern to generate the coupon code with.
                  minLength: 1
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules applied by default to the coupons
                    created with this coupon definition.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                discount_rule_id:
                  description: >-
                    Unique identifier of the discount rule applied by default to
                    the coupons.
                  type: string
                  minLength: 1
                channel_types:
                  type: array
                  items:
                    type: string
                    enum:
                      - web
                      - mobile
                      - mobile_ios
                      - mobile_android
                      - store
                  maxItems: 5
                max_redemptions:
                  description: >-
                    The maximum number of times a coupon based on this
                    definition can be redeemed.
                  type: integer
                  minimum: 1
        required: true
  /coupon_definitions/{id}:
    get:
      tags:
        - Coupon definitions
      summary: Get coupon definition
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon is returned.
          content:
            application/json:
              example:
                schema:
                  id: c4c429fc-9744-41ea-87a0-e081092d63f9
                  label: cybermon678
                  pattern: coupondef-[A-Z]{3}[0-9]{3}
                  validation_rules:
                    - label: valid_from
                      values:
                        valid_from: '2017-10-23T06:00:00.000Z'
                    - label: valid_to
                      values:
                        valid_to: '2019-11-30T23:59:59.000Z'
                  discount_rule_id: f32f4cf6-f65d-4ed9-be4c-26a2b0552a51
                  max_redemptions: 10000000
              schema:
                properties:
                  id:
                    type: string
                    description: >-
                      The coupon definition id generated by NewStore. This is
                      just exposed for tracing reasons. Later you will use your
                      label to create a coupon.
                  label:
                    type: string
                    description: >-
                      Label to identify the coupon definition by. Must be
                      unique, second call with the same label will fail.
                    minLength: 1
                  pattern:
                    type: string
                    description: RegEx pattern to generate the coupon code with.
                    minLength: 1
                  validation_rules:
                    type: array
                    description: >-
                      A list of validation rules that are going to be applied by
                      default to the coupons, created with this coupon
                      definition.
                    items:
                      anyOf:
                        - required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - valid_from
                            values:
                              type: object
                              required:
                                - valid_from
                              properties:
                                valid_from:
                                  type: string
                                  description: >-
                                    Coupon is valid starting this date. Can be
                                    overwritten by the coupon. Provide a date in
                                    the following format:
                                    '2006-01-02T15:04:05.999999Z'
                                  format: date-time
                          title: Valid from validation rule object
                          type: object
                        - title: Valid to validation rule object
                          type: object
                          required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - valid_to
                            values:
                              type: object
                              required:
                                - valid_to
                              properties:
                                valid_to:
                                  type: string
                                  description: >-
                                    Coupon is valid until this date. Can be
                                    overwritten by the coupon. Provide a date in
                                    the following format:
                                    '2006-01-02T15:04:05.999999Z'
                                  format: date-time
                        - title: Restricted to consumer id validation rule object
                          type: object
                          required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - restricted_to_consumer_id
                            values:
                              type: object
                              required:
                                - consumer_id
                              properties:
                                consumer_id:
                                  type: string
                                  description: >-
                                    Consumer id that this coupon is restricted
                                    to (only this consumer id can be used to
                                    redeem the coupon). Can not be overwritten
                                    by the coupon but can be set for the coupon
                                    if not provided for the definition
                                    (template).
                                  minLength: 1
                  discount_rule_id:
                    description: >-
                      Unique identifier of the discount rule which is going to
                      be applied by default to the coupons.
                    type: string
                    minLength: 1
                  channel_types:
                    type: array
                    items:
                      type: string
                      enum:
                        - web
                        - mobile
                        - mobile_ios
                        - mobile_android
                        - store
                    maxItems: 5
                  max_redemptions:
                    description: >-
                      The maximum number of times a coupon linked to this
                      definition can be redeemed.
                    type: integer
                title: Coupon definition object
                type: object
        '404':
          description: Could not find the coupon definition with the specified ID.
      description: |
        Returns the coupon definition for the coupon with the specified ID.
      operationId: GetCouponDefinition
    put:
      tags:
        - Coupon definitions
      summary: Update coupon definition
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon was updated.
          content:
            application/json:
              example:
                schema:
                  id: c4c429fc-9744-41ea-87a0-e081092d63f9
                  label: cybermon678
                  pattern: coupondef-[A-Z]{3}[0-9]{3}
                  validation_rules:
                    - label: valid_from
                      values:
                        valid_from: '2017-10-23T06:00:00.000Z'
                    - label: valid_to
                      values:
                        valid_to: '2019-11-30T23:59:59.000Z'
                  discount_rule_id: f32f4cf6-f65d-4ed9-be4c-26a2b0552a51
                  max_redemptions: 10000000
              schema:
                properties:
                  id:
                    type: string
                    description: >-
                      The coupon definition id generated by NewStore. This is
                      just exposed for tracing reasons. Later you will use your
                      label to create a coupon.
                  label:
                    type: string
                    description: >-
                      Label to identify the coupon definition by. Must be
                      unique, second call with the same label will fail.
                    minLength: 1
                  pattern:
                    type: string
                    description: RegEx pattern to generate the coupon code with.
                    minLength: 1
                  validation_rules:
                    type: array
                    description: >-
                      A list of validation rules that are going to be applied by
                      default to the coupons, created with this coupon
                      definition.
                    items:
                      anyOf:
                        - required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - valid_from
                            values:
                              type: object
                              required:
                                - valid_from
                              properties:
                                valid_from:
                                  type: string
                                  description: >-
                                    Coupon is valid starting this date. Can be
                                    overwritten by the coupon. Provide a date in
                                    the following format:
                                    '2006-01-02T15:04:05.999999Z'
                                  format: date-time
                          title: Valid from validation rule object
                          type: object
                        - title: Valid to validation rule object
                          type: object
                          required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - valid_to
                            values:
                              type: object
                              required:
                                - valid_to
                              properties:
                                valid_to:
                                  type: string
                                  description: >-
                                    Coupon is valid until this date. Can be
                                    overwritten by the coupon. Provide a date in
                                    the following format:
                                    '2006-01-02T15:04:05.999999Z'
                                  format: date-time
                        - title: Restricted to consumer id validation rule object
                          type: object
                          required:
                            - label
                            - values
                          properties:
                            label:
                              type: string
                              enum:
                                - restricted_to_consumer_id
                            values:
                              type: object
                              required:
                                - consumer_id
                              properties:
                                consumer_id:
                                  type: string
                                  description: >-
                                    Consumer id that this coupon is restricted
                                    to (only this consumer id can be used to
                                    redeem the coupon). Can not be overwritten
                                    by the coupon but can be set for the coupon
                                    if not provided for the definition
                                    (template).
                                  minLength: 1
                  discount_rule_id:
                    description: >-
                      Unique identifier of the discount rule which is going to
                      be applied by default to the coupons.
                    type: string
                    minLength: 1
                  channel_types:
                    type: array
                    items:
                      type: string
                      enum:
                        - web
                        - mobile
                        - mobile_ios
                        - mobile_android
                        - store
                    maxItems: 5
                  max_redemptions:
                    description: >-
                      The maximum number of times a coupon linked to this
                      definition can be redeemed.
                    type: integer
                title: Coupon definition object
                type: object
        '400':
          description: Invalid input data.
        '404':
          description: Could not find the coupon definition with the specified ID.
      description: |
        Overwrites the coupon definition with the specified ID, using
        the updated coupon definition specified in the payload.
      operationId: UpdateCouponDefinition
      requestBody:
        content:
          application/json:
            example:
              coupon_definition_update:
                schema:
                  pattern: coupondef-[A-Z]{3}[0-9]{3}
                  validation_rules:
                    - label: valid_from
                      values:
                        valid_from: '2017-10-23T06:00:00.000Z'
                    - label: valid_to
                      values:
                        valid_to: '2019-11-30T23:59:59.000Z'
                  label: cybermon678
                  discount_rule_id: f32f4cf6-f65d-4ed9-be4c-26a2b0552a51
                  max_redemptions: 10000000
            schema:
              title: Create coupon definition request
              type: object
              description: >-
                A definition is required to create a coupon. Some of the
                properties set in the definition can be overwritten by the
                coupon itself at coupon creation time.
              required:
                - label
                - pattern
                - discount_rule_id
              properties:
                label:
                  type: string
                  description: >-
                    Label to identify the coupon definition by. Must be unique,
                    second call with the same label will fail.
                  minLength: 1
                pattern:
                  type: string
                  description: RegEx pattern to generate the coupon code with.
                  minLength: 1
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules applied by default to the coupons
                    created with this coupon definition.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                discount_rule_id:
                  description: >-
                    Unique identifier of the discount rule applied by default to
                    the coupons.
                  type: string
                  minLength: 1
                channel_types:
                  type: array
                  items:
                    type: string
                    enum:
                      - web
                      - mobile
                      - mobile_ios
                      - mobile_android
                      - store
                  maxItems: 5
                max_redemptions:
                  description: >-
                    The maximum number of times a coupon based on this
                    definition can be redeemed.
                  type: integer
                  minimum: 1
        required: true
    delete:
      tags:
        - Coupon definitions
      summary: Delete coupon definition
      security:
        - newStoreAccessToken: []
      responses:
        '204':
          description: The coupon definition was deleted.
        '404':
          description: The coupon definition with the specified ID could not be found.
      description: >
        Deletes the coupon definition with the specified ID.


        **Note**: You cannot delete the coupon definition for a coupon that has
        been used at

        least once.
      operationId: DeleteCouponDefinition
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
  /coupons:
    post:
      tags:
        - Coupons
      summary: Create coupon
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon was successfully created.
          content:
            application/json:
              example:
                schema:
                  label: loyalty_feb
                  code: COUPON_bf3sK
                  id: 5d3e00b3-20c1-4268-832c-e299527e3d33
                  is_enabled: true
              schema:
                title: Create coupon response
                type: object
                required:
                  - id
                  - code
                properties:
                  id:
                    description: >-
                      Unique identifier of created coupon definition (template)
                      (currently, uuid)
                    type: string
                    minLength: 36
                    maxLength: 36
                  code:
                    type: string
                    description: Generated coupon code
                    minLength: 1
                  label:
                    type: string
                    description: Returned whenever there is a label assigned to the coupon.
                    minLength: 1
                  is_enabled:
                    type: boolean
                    description: Is true when the coupon is enabled
        '400':
          description: Something went wrong with the request.
      description: |
        Creates a coupon from an existing definition. This method links
        the existing coupon definition to the coupon.
      operationId: CreateCoupon
      requestBody:
        content:
          application/json:
            example:
              coupon_create:
                schema:
                  label: loyaltyfeb
                  template_label: loyalty
                  validation_rules:
                    - values:
                        consumer_id: 8de1d881-2572-4848-b3f7-e8cb9a45b4f5
                      label: restricted_to_consumer_id
            schema:
              title: Create coupon request
              type: object
              required:
                - template_label
              properties:
                label:
                  type: string
                  description: Optional label to apply to the coupon.
                template_label:
                  type: string
                  description: >-
                    Coupon definition (template) label to create coupon by.
                    Multiple coupons can be created using the same label.
                  minLength: 1
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules to be applied to the coupon. The
                    list provided here is intersected with the one coupon
                    definition (template) provides, and validation rules from
                    this list either override the ones of the coupon definition
                    or produce a conflict, depending on the rule.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                      - properties:
                          label:
                            type: string
                            enum:
                              - min_total_before_discount
                          values:
                            type: object
                            required:
                              - amount
                            properties:
                              amount:
                                description: >-
                                  DEPRECATED. Set minimal order value for the
                                  discount rule instead. Minimal order total
                                  value before the coupon can be applied
                                required:
                                  - value
                                  - currency
                                properties:
                                  value:
                                    type: number
                                    minimum: 0
                                  currency:
                                    type: string
                                title: Monetary amount object
                                type: object
                        title: >-
                          Minimal order total before discount validation rule
                          object
                        type: object
                        required:
                          - label
                          - values
                amount:
                  description: >-
                    DEPRECATED. Amount is taken from the discount rule. In the
                    deprecated case of no discount rule, amount must be provided
                    either here or on the corresponding definition (template).
                    Amount provided here can not override the one provided by
                    coupon definition.
                  required:
                    - value
                    - currency
                  properties:
                    value:
                      type: number
                      minimum: 0
                    currency:
                      type: string
                  title: Monetary amount object
                  type: object
                discount_rule_id:
                  description: >-
                    DEPRECATED. Use coupon definitions (templates) with attached
                    discount_rule_id. Unique identifier of the discount rule
                    which is attached to the coupon.
                  type: string
                  minLength: 1
        required: true
  /coupons/{id}:
    post:
      deprecated: true
      tags:
        - Coupons
      summary: '[DEPRECATED] Update coupon'
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon was successfully updated.
          content:
            application/json:
              example:
                schema:
                  label: loyalty_feb
                  code: COUPON_bf3sK
                  id: 5d3e00b3-20c1-4268-832c-e299527e3d33
                  is_enabled: false
              schema:
                title: Create coupon response
                type: object
                required:
                  - id
                  - code
                properties:
                  id:
                    description: >-
                      Unique identifier of created coupon definition (template)
                      (currently, uuid)
                    type: string
                    minLength: 36
                    maxLength: 36
                  code:
                    type: string
                    description: Generated coupon code
                    minLength: 1
                  label:
                    type: string
                    description: Returned whenever there is a label assigned to the coupon.
                    minLength: 1
                  is_enabled:
                    type: boolean
                    description: Is true when the coupon is enabled
        '404':
          description: Could not find the coupon with the given id.
      description: >
        This endpoint is deprecated. Use [Update coupon
        partially](#operation/UpdateCoupon) instead.


        Updates the `is_enabled` parameter of a coupon. When set to `false`

        the coupon is not redeemable and cannot be used during checkout.
      operationId: UpdateCouponDeprecated
      requestBody:
        content:
          application/json:
            example:
              update-coupon:
                schema:
                  is_enabled: false
                  validation_rules:
                    - values:
                        consumer_id: 8de1d881-2572-4848-b3f7-e8cb9a45b4f5
                      label: restricted_to_consumer_id
            schema:
              title: Update coupon request
              type: object
              properties:
                is_enabled:
                  type: boolean
                  description: Is true when the coupon is enabled
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules to be applied to the coupon. The
                    list provided here is intersected with the one coupon
                    definition (template) provides, and validation rules from
                    this list either override the ones of the coupon definition
                    or produce a conflict, depending on the rule.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                      - properties:
                          label:
                            type: string
                            enum:
                              - min_total_before_discount
                          values:
                            type: object
                            required:
                              - amount
                            properties:
                              amount:
                                description: >-
                                  DEPRECATED. Set minimal order value for the
                                  discount rule instead. Minimal order total
                                  value before the coupon can be applied
                                required:
                                  - value
                                  - currency
                                properties:
                                  value:
                                    type: number
                                    minimum: 0
                                  currency:
                                    type: string
                                title: Monetary amount object
                                type: object
                        title: >-
                          Minimal order total before discount validation rule
                          object
                        type: object
                        required:
                          - label
                          - values
        required: true
    patch:
      tags:
        - Coupons
      summary: Update coupon partially
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon was successfully updated.
          content:
            application/json:
              example:
                schema:
                  label: loyalty_feb
                  code: COUPON_bf3sK
                  id: 5d3e00b3-20c1-4268-832c-e299527e3d33
                  is_enabled: false
              schema:
                title: Create coupon response
                type: object
                required:
                  - id
                  - code
                properties:
                  id:
                    description: >-
                      Unique identifier of created coupon definition (template)
                      (currently, uuid)
                    type: string
                    minLength: 36
                    maxLength: 36
                  code:
                    type: string
                    description: Generated coupon code
                    minLength: 1
                  label:
                    type: string
                    description: Returned whenever there is a label assigned to the coupon.
                    minLength: 1
                  is_enabled:
                    type: boolean
                    description: Is true when the coupon is enabled
        '404':
          description: Could not find the coupon with the given id.
      description: >
        Updates several parameters of a coupon. When `is_enabled` is set to
        `false`,

        the coupon is not redeemable and cannot be used during checkout.
      operationId: UpdateCoupon
      requestBody:
        content:
          application/json:
            example:
              update_coupon:
                schema:
                  is_enabled: false
                  validation_rules:
                    - values:
                        consumer_id: 8de1d881-2572-4848-b3f7-e8cb9a45b4f5
                      label: restricted_to_consumer_id
            schema:
              title: Update coupon request
              type: object
              properties:
                is_enabled:
                  type: boolean
                  description: Is true when the coupon is enabled
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules to be applied to the coupon. The
                    list provided here is intersected with the one coupon
                    definition (template) provides, and validation rules from
                    this list either override the ones of the coupon definition
                    or produce a conflict, depending on the rule.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                      - properties:
                          label:
                            type: string
                            enum:
                              - min_total_before_discount
                          values:
                            type: object
                            required:
                              - amount
                            properties:
                              amount:
                                description: >-
                                  DEPRECATED. Set minimal order value for the
                                  discount rule instead. Minimal order total
                                  value before the coupon can be applied
                                required:
                                  - value
                                  - currency
                                properties:
                                  value:
                                    type: number
                                    minimum: 0
                                  currency:
                                    type: string
                                title: Monetary amount object
                                type: object
                        title: >-
                          Minimal order total before discount validation rule
                          object
                        type: object
                        required:
                          - label
                          - values
        required: true
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        description: coupon ID
  /coupon_templates:
    post:
      tags:
        - Coupon templates
      summary: Create coupon template
      security:
        - newStoreAccessToken: []
      responses:
        '200':
          description: The coupon template was successfully created.
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                  - label
                properties:
                  id:
                    type: string
                    description: >-
                      The coupon template id generated by NewStore. This is just
                      exposed for tracing reasons. Later you will use your label
                      to create a coupon.
                  label:
                    type: string
                    description: The provided template label
        '400':
          description: Something was wrong with the request.
      description: |
        Creates a coupon template which is later used to create a coupon itself.
      operationId: CreateCouponTemplate
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - label
                - pattern
              properties:
                label:
                  type: string
                  description: >-
                    Label to identify the coupon template by. Must be unique,
                    second call with the same label will fail.
                  minLength: 1
                pattern:
                  type: string
                  description: RegEx pattern to generate the coupon code with.
                  minLength: 1
                validation_rules:
                  type: array
                  description: >-
                    A list of validation rules that are going to be applied by
                    default to the coupons, created with this coupon template.
                  items:
                    anyOf:
                      - required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_from
                          values:
                            type: object
                            required:
                              - valid_from
                            properties:
                              valid_from:
                                type: string
                                description: >-
                                  Coupon is valid starting this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                        title: Valid from validation rule object
                        type: object
                      - title: Valid to validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - valid_to
                          values:
                            type: object
                            required:
                              - valid_to
                            properties:
                              valid_to:
                                type: string
                                description: >-
                                  Coupon is valid until this date. Can be
                                  overwritten by the coupon. Provide a date in
                                  the following format:
                                  '2006-01-02T15:04:05.999999Z'
                                format: date-time
                      - title: Restricted to consumer id validation rule object
                        type: object
                        required:
                          - label
                          - values
                        properties:
                          label:
                            type: string
                            enum:
                              - restricted_to_consumer_id
                          values:
                            type: object
                            required:
                              - consumer_id
                            properties:
                              consumer_id:
                                type: string
                                description: >-
                                  Consumer id that this coupon is restricted to
                                  (only this consumer id can be used to redeem
                                  the coupon). Can not be overwritten by the
                                  coupon but can be set for the coupon if not
                                  provided for the definition (template).
                                minLength: 1
                      - properties:
                          label:
                            type: string
                            enum:
                              - min_total_before_discount
                          values:
                            type: object
                            required:
                              - amount
                            properties:
                              amount:
                                description: >-
                                  DEPRECATED. Set minimal order value for the
                                  discount rule instead. Minimal order total
                                  value before the coupon can be applied
                                required:
                                  - value
                                  - currency
                                properties:
                                  value:
                                    type: number
                                    minimum: 0
                                  currency:
                                    type: string
                                title: Monetary amount object
                                type: object
                        title: >-
                          Minimal order total before discount validation rule
                          object
                        type: object
                        required:
                          - label
                          - values
                amount:
                  description: >-
                    Amount to be applied to the coupons created with this coupon
                    template.
                  required:
                    - value
                    - currency
                  properties:
                    value:
                      type: number
                      minimum: 0
                    currency:
                      type: string
                  title: Monetary amount object
                  type: object
              title: Create coupon template request
        required: true
components:
  schemas: {}
  responses: {}
  parameters: {}
  examples: {}
  requestBodies: {}
  headers: {}
  securitySchemes:
    newStoreAccessToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
  links: {}
  callbacks: {}